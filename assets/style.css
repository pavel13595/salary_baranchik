/* Legacy stylesheet: styles have been split into modular files under /css/.
   Safe to delete /assets directory. */

:root {
  --bg: #0f1115;
  --bg-alt:#181c23;
  --panel:#1f242d;
  --panel-alt:#262d38;
  --text:#e6eaf1;
  --text-dim:#96a0b2;
  --accent:#4f9cff;
  --accent-grad:linear-gradient(135deg,#4f9cff,#5f6fff 60%,#9b51ff);
  --border:#2f3844;
  --danger:#ff4d61;
  --warn:#ffa600;
  --success:#2ecc71;
  --radius:14px;
  --focus:0 0 0 2px rgba(79,156,255,.4);
  font-family:'Inter',system-ui,sans-serif;
}
.light {
  --bg:#f5f7fb; --bg-alt:#fff; --panel:#ffffff; --panel-alt:#f1f4f9; --text:#1b2430; --text-dim:#64707f; --border:#dae2ec; --accent:#2563eb; --accent-grad:linear-gradient(135deg,#2563eb,#6366f1 60%,#9333ea); --danger:#dc2626; --warn:#d97706; --success:#059669;
}
* { box-sizing:border-box; }
html,body { margin:0; padding:0; background:var(--bg); color:var(--text); min-height:100%; }
body { display:flex; flex-direction:column; }

.app-header { padding: clamp(10px,1.5vw,24px); display:flex; flex-wrap:wrap; align-items:center; gap:20px; background:var(--bg-alt); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:10; }
.app-header h1 { font-size:clamp(1.3rem,2.1vw,2.1rem); margin:0; font-weight:600; letter-spacing:.5px; background:var(--accent-grad); -webkit-background-clip:text; background-clip:text; color:transparent; }
.actions-row { display:flex; flex-wrap:wrap; gap:18px; width:100%; justify-content:space-between; align-items:flex-start; }
button { --pad:10px 18px; font-family:inherit; font-size:.85rem; font-weight:500; letter-spacing:.4px; padding:var(--pad); border-radius:8px; background:var(--panel-alt); color:var(--text); border:1px solid var(--border); cursor:pointer; display:inline-flex; align-items:center; gap:6px; transition:.25s; position:relative; }
button.primary { background:var(--accent-grad); color:#fff; border:none; }
button.accent { background:linear-gradient(135deg,#16a34a,#22c55e); border:none; }
button.warn { background:var(--warn); color:#000; border:none; }
button.danger { background:var(--danger); color:#fff; border:none; }
button.subtle { filter:brightness(.9); }
button:hover { transform:translateY(-2px); box-shadow:0 6px 18px -8px rgba(0,0,0,.6),0 2px 4px -1px rgba(0,0,0,.4); }
button:active { transform:translateY(0); }
button:focus-visible { outline:none; box-shadow:var(--focus); }

main { width:100%; max-width:1600px; margin: 24px auto 80px; padding:0 24px; flex:1; display:grid; gap:32px; grid-template-columns:1fr; }
.panel { background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); padding:24px 26px 30px; position:relative; overflow:hidden; }
.panel h2 { margin:0 0 18px; font-size:1.1rem; letter-spacing:.5px; font-weight:600; }

.summary-grid { display:grid; gap:14px; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); }
.summary-item { padding:14px 16px 13px; background:var(--panel-alt); border:1px solid var(--border); border-radius:12px; display:flex; flex-direction:column; gap:4px; position:relative; }
.summary-item small { color:var(--text-dim); font-size:.65rem; text-transform:uppercase; letter-spacing:.8px; font-weight:600; }
.summary-item span { font-size:1.05rem; font-weight:600; }

.table-container { width:100%; overflow:auto; border:1px solid var(--border); border-radius:14px; background:var(--panel-alt); }
.payroll-table { width:100%; border-collapse:collapse; font-size:.8rem; line-height:1.25; }
.payroll-table th, .payroll-table td { padding:8px 10px; text-align:left; border-bottom:1px solid var(--border); vertical-align:top; }
.payroll-table th { position:sticky; top:0; background:var(--panel-alt); font-size:.7rem; letter-spacing:.8px; text-transform:uppercase; color:var(--text-dim); font-weight:600; backdrop-filter:blur(6px); }
.payroll-table th:nth-child(2),
.payroll-table td:nth-child(2){ text-align:center; }
.payroll-table tbody tr:last-child td { border-bottom:none; }
.payroll-table tbody tr.group-row td { background:rgba(255,255,255,.04); font-weight:600; color:var(--accent); font-size:.75rem; letter-spacing:1px; text-transform:uppercase; }
.payroll-table tbody tr.group-row td { padding:14px 14px; border-top:2px solid var(--border); border-bottom:2px solid var(--border); background:linear-gradient(90deg,var(--panel-alt),rgba(0,0,0,0)); }
.payroll-table td.editable { cursor:text; background:rgba(255,255,255,.02); min-width:90px; }
.payroll-table td.editable:focus { outline:1px solid var(--accent); background:rgba(79,156,255,.08); }
.payroll-table td.pay { font-weight:600; color:var(--success); }
.payroll-table tr:hover { background:rgba(255,255,255,.02); }

.status-pill { display:inline-flex; align-items:center; gap:6px; font-size:.6rem; padding:4px 8px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid var(--border); letter-spacing:.8px; text-transform:uppercase; font-weight:600; color:var(--text-dim); }

.modal-layer { position:fixed; inset:0; background:rgba(15,17,21,.72); backdrop-filter:blur(12px) saturate(160%); -webkit-backdrop-filter:blur(12px) saturate(160%); display:flex; align-items:flex-start; justify-content:center; overflow-y:auto; padding:60px 24px 100px; z-index:100; }
.modal-layer.hidden { display:none; }
.modal { width:100%; max-width:860px; background:var(--panel); border:1px solid var(--border); border-radius:24px; padding:40px clamp(24px,3vw,50px) 46px; position:relative; display:flex; flex-direction:column; gap:26px; animation:pop .45s cubic-bezier(.21,1.02,.73,1); }
.modal h3 { margin:0; font-size:1.3rem; font-weight:600; letter-spacing:.6px; }
.close-btn { position:absolute; top:12px; right:12px; background:transparent; border:none; font-size:1.2rem; line-height:1; }
textarea { width:100%; min-height:260px; resize:vertical; padding:16px 18px; font-family:ui-monospace,monospace; font-size:.8rem; line-height:1.4; background:var(--bg-alt); color:var(--text); border:1px solid var(--border); border-radius:14px; }
textarea.short { min-height:160px; }
label span { display:block; font-size:.65rem; font-weight:600; letter-spacing:.8px; color:var(--text-dim); text-transform:uppercase; margin-bottom:6px; }
.inline-fields { display:flex; gap:18px; flex-wrap:wrap; }
.inline-fields > * { flex:1 1 220px; }
.input { display:flex; flex-direction:column; gap:6px; }
.input input, .input select { padding:14px 16px; background:var(--bg-alt); color:var(--text); border:1px solid var(--border); border-radius:12px; font-size:.8rem; }
.helper { font-size:.65rem; color:var(--text-dim); line-height:1.3; }

.modal footer { display:flex; gap:14px; flex-wrap:wrap; justify-content:flex-end; }
.modal footer button { font-size:.75rem; }

.badge { display:inline-block; padding:4px 8px 3px; font-size:.55rem; letter-spacing:.8px; background:var(--accent-grad); -webkit-background-clip:text; background-clip:text; color:transparent; font-weight:700; text-transform:uppercase; }
.drag-handle { cursor:grab; }

.toast-container { position:fixed; bottom:28px; right:28px; display:flex; flex-direction:column; gap:12px; z-index:200; }
.toast { background:var(--panel); border:1px solid var(--border); padding:14px 18px 16px; border-radius:14px; font-size:.75rem; display:flex; gap:14px; align-items:flex-start; animation:slideIn .5s cubic-bezier(.21,1.02,.73,1); max-width:360px; }
.toast.success { border-color:rgba(46,204,113,.4); }
.toast.error { border-color:rgba(255,77,97,.5); }
.toast button { background:transparent; border:none; font-size:.8rem; padding:4px; margin-left:auto; }

@keyframes pop { 0% { transform:translateY(30px) scale(.95); opacity:0; } 100% { transform:translateY(0) scale(1); opacity:1; } }
@keyframes slideIn { 0% { transform:translateY(18px); opacity:0; } 100% { transform:translateY(0); opacity:1; } }

.app-footer { padding:30px 20px 60px; text-align:center; font-size:.65rem; color:var(--text-dim); }

.empty { padding:80px 30px; text-align:center; color:var(--text-dim); font-size:.85rem; }

::-webkit-scrollbar { width:10px; height:10px; }
::-webkit-scrollbar-track { background:var(--bg-alt); }
::-webkit-scrollbar-thumb { background:var(--panel-alt); border-radius:20px; border:2px solid var(--bg-alt); }
::-webkit-scrollbar-thumb:hover { background:var(--accent); }

.mark-need-sales { background:linear-gradient(90deg, rgba(255,166,0,.18), transparent); }
.mark-fixed { background:linear-gradient(90deg, rgba(99,102,241,.15), transparent); }

.inline-edit-btn { font-size:.55rem; padding:4px 6px; margin-left:6px; }

.filter-bar { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:14px; }
.filter-bar input { padding:10px 14px; background:var(--panel-alt); border:1px solid var(--border); border-radius:10px; font-size:.75rem; color:var(--text); }

.search-highlight { background:linear-gradient(90deg,#9333ea33,#2563eb33); border-radius:4px; padding:0 2px; }

.fade-in { animation:fadeIn .6s ease; }
@keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }

.layout-modal-top { position:sticky; top:0; z-index:5; background:var(--panel); padding:8px 0 12px; border-bottom:1px solid var(--border); margin-bottom:14px; }
.layout-modal-top .inline-fields { align-items:flex-end; }
.layout-columns-scroll { max-height:360px; overflow:auto; padding:6px 8px 14px 6px; border:1px solid var(--border); border-radius:16px; background:var(--panel-alt); }
.layout-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(170px,1fr)); gap:10px; }
.layout-cell { background:var(--panel); border:1px solid var(--border); padding:6px 8px 10px; border-radius:12px; display:flex; flex-direction:column; gap:6px; min-width:0; position:relative; }
.layout-cell header { display:flex; gap:4px; align-items:center; }
.layout-cell header input { flex:1; min-width:0; font-size:.55rem; padding:4px 6px; }
.layout-cell footer { display:flex; justify-content:space-between; align-items:center; margin-top:4px; }
.layout-cell footer small { font-size:.5rem; letter-spacing:.8px; opacity:.7; }
.layout-mini-sample { font-size:.55rem; background:var(--panel-alt); border:1px solid var(--border); border-radius:8px; padding:4px 6px; line-height:1.2; display:flex; justify-content:space-between; gap:6px; }
.layout-mini-sample span { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:70%; }
.layout-mini-sample code { font-size:.55rem; opacity:.7; }
.layout-cell.dragging { opacity:.45; outline:2px dashed var(--accent); }
.layout-preview-wrapper { margin-top:18px; display:grid; gap:18px; }
@media (min-width:1100px){ .layout-preview-wrapper { grid-template-columns:1fr 1fr; } }
.preview-block { background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:14px 16px 18px; }
.preview-block h4 { font-size:.65rem; margin:0 0 8px; letter-spacing:.8px; font-weight:600; color:var(--text-dim); }
.preview-scroller { overflow:auto; max-height:260px; }
.layout-preview-table { width:100%; border-collapse:collapse; font-size:.58rem; }
.layout-preview-table th, .layout-preview-table td { border:1px solid var(--border); padding:4px 6px; text-align:center; white-space:nowrap; }
.layout-preview-table th { background:var(--panel-alt); position:sticky; top:0; }
.badge-action { background:var(--accent-grad); -webkit-background-clip:text; background-clip:text; color:transparent; font-weight:600; font-size:.55rem; cursor:pointer; }
/* === Excel Layout Editor (refined) === */
.excel-layout-shell { display:flex; flex-direction:column; gap:18px; }
@media (min-width:1150px){ .excel-layout-main { display:grid; grid-template-columns:1fr 360px; gap:24px; align-items:start; } }
.excel-layout-main { display:flex; flex-direction:column; gap:24px; }
.excel-columns-panel { background:var(--panel-alt); border:1px solid var(--border); border-radius:18px; padding:18px 20px 20px; display:flex; flex-direction:column; gap:16px; min-height:200px; }
.excel-columns-toolbar { display:flex; flex-wrap:wrap; gap:14px; align-items:flex-end; }
.excel-columns-toolbar .input { min-width:160px; }
.excel-columns-scroll { max-height:340px; overflow:auto; padding:6px 4px 4px; border:1px solid var(--border); border-radius:14px; background:var(--panel); }
.layout-grid { grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); }
.layout-cell { background:var(--bg-alt); border:1px solid var(--border); box-shadow:none; transition:.18s border-color, .18s background; }
.layout-cell:hover { border-color:var(--accent); }
.layout-cell header input { background:var(--panel-alt); }
.layout-mini-sample { background:var(--panel-alt); border:none; border-radius:8px; }
.layout-mini-sample code { display:none; }
.layout-cell footer small { opacity:.5; }
.excel-previews { display:flex; flex-direction:column; gap:18px; }
@media (min-width:1150px){ .excel-previews { position:sticky; top:40px; } }
.preview-block { background:var(--panel-alt); border-radius:18px; padding:16px 18px 20px; border:1px solid var(--border); }
.preview-block h4 { font-size:.62rem; letter-spacing:.7px; }
.preview-scroller { max-height:260px; }
.layout-preview-table { font-size:.55rem; }
.layout-preview-table th { background:var(--panel); }
/* Buttons inside editor */
#addColBtn { background:var(--panel); border:1px solid var(--border); color:var(--text); box-shadow:none; }
#addColBtn:hover { background:var(--accent); color:#fff; }
/* Remove gradient inside editor header buttons if any */
.modal .excel-layout-shell button.primary { background:var(--accent); }
/* Scrollbar subtle tweak inside editor */
.excel-columns-scroll::-webkit-scrollbar-thumb { background:var(--panel-alt); }
/* === end refined === */

.layout-editor-table-wrap { border:1px solid var(--border); border-radius:16px; background:var(--panel-alt); padding:12px 14px 6px; overflow:hidden; }
.layout-edit-toolbar { display:flex; flex-wrap:wrap; gap:18px; margin-bottom:12px; align-items:flex-end; }
.layout-edit-toolbar .input span { font-size:.6rem; }
.layout-edit-table { width:100%; border-collapse:separate; border-spacing:0 4px; font-size:.62rem; }
.layout-edit-table th { text-align:left; font-weight:600; font-size:.55rem; letter-spacing:.6px; padding:6px 8px; color:var(--text-dim); }
.layout-edit-table td { background:var(--panel); padding:6px 8px; vertical-align:middle; border:1px solid var(--border); }
.layout-edit-table tbody tr { transition:.15s background; }
.layout-edit-table tbody tr.drag-row { opacity:.5; }
.layout-edit-table tbody tr:hover td { background:var(--panel-alt); }
.layout-edit-table td.compact { padding:4px 6px; }
.layout-edit-table input[type=text], .layout-edit-table input[type=number], .layout-edit-table select { width:100%; font-size:.6rem; padding:4px 6px; background:var(--bg-alt); border:1px solid var(--border); border-radius:6px; color:var(--text); }
.layout-edit-table input[disabled] { opacity:.5; }
.layout-edit-table .drag-grip { cursor:grab; font-size:.75rem; user-select:none; }
.layout-edit-table .del-btn { background:var(--danger); border:none; color:#fff; padding:4px 6px; font-size:.55rem; border-radius:6px; cursor:pointer; }
.layout-edit-table .del-btn:disabled { opacity:.4; cursor:default; }
.sample-badge { display:inline-block; max-width:120px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; font-size:.55rem; background:var(--panel-alt); padding:3px 6px; border-radius:6px; border:1px solid var(--border); }
.formula-input { min-width:140px; }
@media (max-width:1000px){ .formula-input { min-width:100px; } }
/* Scroll container */
.layout-editor-scroll { max-height:340px; overflow:auto; margin-top:4px; }

.actions-row { display:flex; flex-wrap:wrap; gap:18px; width:100%; justify-content:space-between; align-items:flex-start; }
.action-group { display:flex; flex-wrap:wrap; gap:8px; align-items:center; }
.meta-group { display:flex; gap:10px; align-items:center; flex-wrap:wrap; background:var(--panel); padding:8px 12px; border:1px solid var(--border); border-radius:14px; box-shadow:0 4px 16px -10px rgba(0,0,0,.6); }
.meta-group .field { position:relative; }
.meta-group input { padding:10px 14px; background:var(--bg-alt); border:1px solid var(--border); border-radius:10px; color:var(--text); font-size:.75rem; min-width:140px; font-family:inherit; box-shadow:inset 0 0 0 1px rgba(255,255,255,.02); transition:.25s; }
.meta-group input:hover { border-color:var(--accent); }
.meta-group input:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 2px rgba(79,156,255,.35); }
button.outline-accent { background:transparent; border:1px solid var(--accent); color:var(--accent); }
button.outline-accent:hover { background:var(--accent); color:#fff; }
@media (max-width:900px){ .actions-row { flex-direction:column; gap:14px; } .meta-group { width:100%; justify-content:flex-start; } }

.tag-fixed { display:inline-block; margin-left:6px; background:var(--danger); color:#fff; font-size:.55rem; padding:2px 5px 3px; border-radius:6px; letter-spacing:.5px; font-weight:600; }
.context-menu { position:fixed; z-index:300; background:var(--panel); border:1px solid var(--border); border-radius:10px; padding:6px 0; min-width:200px; box-shadow:0 8px 28px -8px rgba(0,0,0,.6); animation:fadeIn .16s ease; }
.context-menu button { width:100%; background:transparent; border:none; border-radius:0; justify-content:flex-start; font-size:.7rem; padding:8px 14px; text-align:left; gap:10px; }
.context-menu button:hover { background:var(--panel-alt); transform:none; box-shadow:none; }
.context-menu hr { border:none; border-top:1px solid var(--border); margin:6px 0; }
